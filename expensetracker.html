<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Expense Tracker</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: linear-gradient(to right, #cbdcf5, #d4e2f9);
    }

    .container {
      display: flex;
      gap: 20px;
      padding: 30px;
    }

    .card {
      background: #fff;
      border-radius: 15px;
      padding: 20px;
      flex: 1;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    h2 {
      margin-bottom: 20px;
    }

    .row {
      display: flex;
      gap: 10px;
      margin-bottom: 10px;
    }

    input, select, button {
      padding: 10px;
      font-size: 14px;
      border-radius: 5px;
      border: 1px solid #ccc;
      flex: 1;
    }

    button {
      background: #685cf1;
      color: white;
      border: none;
      cursor: pointer;
    }

    .expenses {
      margin-top: 20px;
    }

    .expense-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      font-size: 14px;
    }

    button.delete-btn {
    width:100px;
  padding: 6px 12px;
  font-size: 14px;
  background-color: #e74c3c;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  margin-left: 10px;
}

    button.add-btn {
    width:150px;
  padding: 10px 20px;
  font-size: 16px;
  background-color: #6c47ff;
  color: white;
  border: none;
  border-radius: 10px;
  cursor: pointer;
}

    .chart-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      margin-bottom: 20px;
    }

    .chart-buttons button {
      flex: 1 1 45%;
    }

    canvas {
      max-width: 100%;
    }

    .category-totals {
      margin-top: 20px;
      font-weight: bold;
    }

    #expenseChart {
  max-height: 500px;
  margin: auto;
  display: block;
}

  </style>
</head>
<body>

<div class="container">
  <!-- Input Section -->
  <div class="card">
    <h2>Add Expense</h2>
    <div class="row">
      <input type="text" id="description" placeholder="Description">
      <input type="number" id="amount" placeholder="Amount (₹)">
    </div>
    <div class="row">
      <input type="date" id="date">
      <select id="category">
        <option value="Food">Food</option>
        <option value="Transport">Transport</option>
        <option value="Shopping">Shopping</option>
        <option value="Bills">Bills</option>
        <option value="Health">Health</option>
        <option value="Education">Education</option>
        <option value="Other">Other</option>
      </select>
    </div>
    <button class="add-btn" onclick="addExpense()">Add</button>
    <div class="expenses" id="expensesList"></div>
  </div>

  <!-- Analytics Section -->
  <div class="card">
    <h2>Analytics</h2>
    <div class="chart-buttons">
      <button onclick="filterByMonth('prev')">Previous Month</button>
      <button onclick="filterByMonth('next')">Next Month</button>
      <button onclick="filterByWeek()">This Week</button>
      <button onclick="filterByMonth('current')">This Month</button>
    </div>
    <canvas id="expenseChart" style="max-height: 500px;"></canvas>
    <br>
    <div class="category-totals" id="categoryTotals"></div>
    <br>
  </div>
</div>

<script>
  let expenses = JSON.parse(localStorage.getItem('expenses')) || [];

  function saveToLocalStorage() {
    localStorage.setItem('expenses', JSON.stringify(expenses));
  }

  function addExpense() {
    const desc = document.getElementById('description').value;
    const amount = parseFloat(document.getElementById('amount').value);
    const date = document.getElementById('date').value;
    const category = document.getElementById('category').value;

    if (!desc || !amount || !date || !category) return;

    expenses.push({ desc, amount, date, category });
    saveToLocalStorage();

    document.getElementById('description').value = '';
    document.getElementById('amount').value = '';
    document.getElementById('date').value = '';
    document.getElementById('category').value = 'Food';

    renderExpenses();
    updateChart();
  }

  function deleteExpense(index) {
    expenses.splice(index, 1);
    saveToLocalStorage();
    renderExpenses();
    updateChart();
  }

  function renderExpenses() {
    const list = document.getElementById('expensesList');
    list.innerHTML = '';
    expenses.forEach((exp, i) => {
      const div = document.createElement('div');
      div.className = 'expense-item';
      div.innerHTML = `
  <div style="flex: 1;">
    ${exp.date} - ₹${exp.amount} - ${exp.category} - ${exp.desc}
  </div>
  <button class="delete-btn" onclick="deleteExpense(${i})">Delete</button>
`;

      list.appendChild(div);
    });
  }

  const ctx = document.getElementById('expenseChart').getContext('2d');
  const chart = new Chart(ctx, {
    type: 'doughnut',
    data: {
      labels: [],
      datasets: [{
        label: 'Expense Amount',
        data: [],
        backgroundColor: ['#FF6384','#36A2EB','#FFCE56','#4BC0C0','#9966FF','#FF9F40','#00A86B']
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: { position: 'bottom' }
      }
    }
  });

  function updateChart(filtered = expenses) {
    const categories = {};
    filtered.forEach(exp => {
      categories[exp.category] = (categories[exp.category] || 0) + exp.amount;
    });

    chart.data.labels = Object.keys(categories);
    chart.data.datasets[0].data = Object.values(categories);
    chart.update();

    const totalText = Object.entries(categories)
      .map(([cat, amt]) => `${cat}:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp₹${amt}`)
      .join('<br>');
    document.getElementById('categoryTotals').innerHTML = `<p>Category Totals:</p>${totalText}`;
  }

  function filterByWeek() {
    const now = new Date();
    const start = new Date(now.setDate(now.getDate() - now.getDay()));
    const end = new Date(start);
    end.setDate(start.getDate() + 6);

    const filtered = expenses.filter(e => {
      const d = new Date(e.date);
      return d >= start && d <= end;
    });

    updateChart(filtered);
  }

  function filterByMonth(type) {
    const now = new Date();
    const month = now.getMonth();
    const year = now.getFullYear();

    let targetMonth = month;
    if (type === 'prev') targetMonth = month - 1;
    if (type === 'next') targetMonth = month + 1;

    const filtered = expenses.filter(e => {
      const d = new Date(e.date);
      return d.getMonth() === targetMonth && d.getFullYear() === year;
    });

    updateChart(filtered);
  }

  // Initialize
  renderExpenses();
  updateChart();
</script>

</body>
</html>
